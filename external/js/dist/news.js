"use strict";var e=1===$(".keski-news-home").length,n=1===$(".news-page").length,a=[],t=!1;"fi"!==document.documentElement.lang.toLowerCase()&&(t=!0);localStorage.getItem("keskiNewsTimestamp");function s(e){return"/"!==(e=e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"")).substring(e.length-1)&&"#"!==e.substring(e.length-1)||(e=e.substring(0,e.length-1)),e}function i(e){var s,i,l,o=null,r=null,c="",p="",w=null,d=null;l=e.perma_link;var g=e.publish_date,u=g.substr(6,4),f=g.substr(3,2),m=g.substr(0,2);p=m+"."+f+".",n&&(p+=u),(c=new Date).setDate(m),c.setMonth(f-1),c.setYear(u),c.setHours(0),c.setMinutes(1),c>new Date||(""!=e.link_url&&(w=e.link_url),0!=e.image&&(d=e.image),s=e.title,""!=e.english_title&&t&&(o=e.english_title),i=e.content,""!=e.english_content&&t&&(r=e.english_content),a.push({url:l,date:c,prettyDate:p,title:s,content:i,titleEn:o,contentEn:r,image:d,link:w}))}function l(){a.sort((function(e,n){var a=new Date(e.date);return new Date(n.date)-a})),e?function(e){for(var n=0;n<4;n++){var i=e[n].prettyDate,l="";null!==e[n].image&&(l='<img class="news-image" alt="" src="'+e[n].image+'">');var o="";if(null!==e[n].link){var r=s(e[n].link);o='<p class="news-link"><i class="fa fa-globe" aria-hidden="true"></i><a  href="'+e[n].link+'">'+r+"</a></p>"}var c=e[n].title;t&&null!==e[n].titleEn&&(c=e[n].titleEn);var p=e[n].content;t&&null!==e[n].contentEn&&(p=e[n].contentEn),p='<div class="news-content">'+p+o+l+"</div>",null==e[n].image&&(e[n].image="https://keski-finna.fi/wp-content/uploads/paakirjasto59_YouTube_820x461_acf_cropped.jpg");var w="<li class='news-item news-li front-page-news-li'><div class='news-container front-page-news-container'><a href='javascript:void(0);' class='news-item-link' data-url='"+a[n].url+"' data-name='"+c+"' data-message='"+p+"'><img class='news-li-image front-page-news-image' alt='' src='"+e[n].image+"'> <div class='news-text-container front-page-news-text-container'><span class='news-li-title front-page-news-li-title'>"+c+"</span><span class='news-li-date front-page-news-date'>"+i+"</span></div></a></div></li>";$("#keskiNewsUl").append(w)}$("#keskiNews .loader").css("display","none")}(a):function(e){for(var n=0;n<e.length;n++){var i=e[n].prettyDate,l="";null!==e[n].image&&(l='<img class="news-image" alt="" src="'+e[n].image+'">');var o="";if(null!==e[n].link){var r=s(e[n].link);o='<p class="news-link"><i class="fa fa-globe" aria-hidden="true"></i><a  href="'+e[n].link+'">'+r+"</a></p>"}var c=e[n].title;t&&null!==e[n].titleEn&&(c=e[n].titleEn);var p=e[n].content;t&&null!==e[n].contentEn&&(p=e[n].contentEn),p='<div class="news-content">'+p+o+l+"</div>",null==e[n].image&&(e[n].image="https://keski-finna.fi/wp-content/uploads/paakirjasto59_YouTube_820x461_acf_cropped.jpg");var w="<li class='news-item news-li news-page-news-li'><div class='news-container news-page-news-container'><a href='javascript:void(0);' class='news-item-link' data-url='"+a[n].url+"' data-name='"+c+"' data-message='"+p+"'><img class='news-li-image news-page-news-image' alt='' src='"+e[n].image+"'> <div class='news-text-container news-page-news-text-container'><span class='news-li-title news-page-news-li-title'>"+c+"</span><span class='news-li-date news-page-news-date'>"+i+"</span></div></a></div></li>";$("#keskiNewsUl").append(w)}$("#keskiNews .loader").css("display","none")}(a),function(){var e=window.location.href;if((e=decodeVal(e)).indexOf("?news=")>-1)for(var n=new RegExp(/\?news=.*/g),t=e.match(n)[0],s=0;s<a.length;s++){if(t==="?news="+a[s].url){var i=a[s].url;setTimeout((function(){$(".news-item").find('[data-url="'+i+'"]').click()}),400)}}$(".news-item-link").on("click",(function(e){var n=$(this).data("name"),a=$(this).data("message");a=(a=(a=(a=a.replace(/^(&nbsp;)+/g,"")).replace(/(<p>&nbsp;<\/p>)+/g,"")).replace(/(<p><\/p>)+/g,"")).replace(/(<p>\s<\/p>)+/g,""),$("#newsModalTitle").replaceWith('<h1 class="modal-title" id="newsModalTitle">'+n+"</h1>"),$("#newsModalBody").replaceWith('<div id="newsModalBody" class="modal-body"><div> <div class="feed-content"><div class="holder">'+a+"</div></div></div></div>"),$("#newsModal").modal("show");var t=$(this).data("url").toString(),s=window.location.href.toString();if(-1===s.indexOf(t)){var i={urlValue:t=s+"?news="+t};history.replaceState(i,n,t)}})),$("#newsModal").on("hide.bs.modal",(function(){var e=window.location.href;if(e.indexOf("?news=")){var n=new RegExp(/\?news=.*/g),a={urlValue:e=e.replace(n,"")};history.replaceState(a,"",e)}}))}()}function o(){$.ajax("https://keski-finna.fi/wp-json/acf/v3/news?per_page=500",{accepts:{xml:"application/json"},dataType:"json",success:function(e){localStorage.setItem("keskiNews",JSON.stringify(e)),$(e).each((function(){i($(this)[0].acf)}))},error:function(e,n,a){console.log(a)},complete:function(){l()}})}(e||n)&&($.getJSON("https://keski-finna.fi/wp-json/acf/v3/cache",(function(e){var n=e[0].acf.news_stamp;if(localStorage.getItem("keskiNewsTimestamp")===n){var a=localStorage.getItem("keskiNews");null!==a?(a=JSON.parse(a),$(a).each((function(){i($(this)[0].acf)})),l()):(localStorage.setItem("keskiNewsTimestamp",n),o())}else localStorage.setItem("keskiNewsTimestamp",n),o()})),$(".close-news-modal").text(i18n.get("Close")));
