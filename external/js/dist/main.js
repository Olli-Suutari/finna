"use strict";var e="";function t(e,t){if("js"==t)(n=document.createElement("script")).setAttribute("type","text/javascript"),n.setAttribute("src",e);else if("css"==t){var n;(n=document.createElement("link")).setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e)}void 0!==n&&document.getElementsByTagName("head")[0].appendChild(n)}function n(){if($(".content-navigation-menu").length){$(".content-navigation-menu h2 a").first().parent().addClass("selected-sub-nav");var e=[];$(".content-navigation-menu h2 a").each((function(){try{var t=$(this.hash)[0].id;void 0!==t&&e.push(t)}catch(e){}}));var t=[];for(i=0;i<e.length;i++){var n=window.scrollY+document.getElementById(e[i]).getBoundingClientRect().top;t.push({id:e[i],pos:n})}var a=[];for(i=0;i<t.length;i++){var s=99999999;i<t.length-1&&(s=t[i+1].pos),a.push({id:t[i].id,pos:t[i].pos-80,posEnd:s+80})}let o=0,r=!1;window.addEventListener("scroll",(function(e){o=window.scrollY,r||(window.requestAnimationFrame((function(){!function(e){for(i=0;i<a.length;i++)e>=a[i].pos&&e<=a[i].posEnd&&($(".selected-sub-nav").removeClass("selected-sub-nav"),$('h2 a[href$="#'+a[i].id+'"').parent().addClass("selected-sub-nav"))}(o),r=!1})),r=!0)}))}}function a(){setTimeout((function(){if(e.indexOf("-test")>-1)return t("https://keski-finna.fi/external/finna/js/newsTest.js","js"),void t("https://keski-finna.fi/external/finna/js/eventsTest.js","js");t("https://keski-finna.fi/external/finna/js/dist/news.js","js"),t("https://keski-finna.fi/external/finna/js/dist/events.js","js")}),1400)}(e=window.location.href).indexOf("/beta/")>-1&&(window.location=e.replace("/beta/","/")),e.indexOf("/content/")>-1&&(window.location=e.replace("/content/","/Content/")),e.indexOf("/web/arena")>-1&&(window.location=e.replace("/web/arena","")),e.indexOf("?lng=fi")>-1?e=e.replace("?lng=fi",""):e.indexOf("?lng=en-gb")>-1&&(e=e.replace("?lng=en-gb","")),t("https://fonts.googleapis.com/css?family=Lato|Open+Sans&display=swap","css"),window.moment||(console.log("Load moment."),t("/keski/themes/custom/js/lib/moment.min.js","js")),window.tileLayer||(console.log("Load Leaflet tile fallback."),t("https://keski-finna.fi/external/finna/js/lib/leafletTileFallback.min.js","js")),window.i18n||s("https://keski-finna.fi/external/finna/js/dist/jquery.translate.js",void(navigator.userAgent.indexOf("MSIE ")>-1||navigator.userAgent.indexOf("Trident/")>-1?s("https://polyfill.io/v3/polyfill.min.js?features=es2015%2Ces2016%2Ces2017%2Ces5%2Ces6%2CArray.prototype.includes%2CString.prototype.includes%2Cdefault%2Cblissfuljs%2CArray.of%2CArray.prototype.some%2CNumber.EPSILON%2Cdocument%2CArray.prototype.every%2CArray.prototype.fill%2CArray.prototype.filter%2CArray.prototype.find%2CArray.prototype.forEach%2CArray.prototype.reduce%2CArray.prototype.lastIndexOf%2CArray.prototype.indexOf%2CscrollIntoView%2CscrollX%2CscrollY%2CArray.isArray%2CArray.from%2Ces7%2Ces2019%2Ces2018",a()):a())),navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS")||/^((?!chrome|android).)*safari/i.test(navigator.userAgent);navigator.userAgent.match(/iPad/i),null!=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i);function s(e,t){var n=document.createElement("script");n.src=e,n.type="text/javascript",n.addEventListener("load",t),document.getElementsByTagName("head")[0].appendChild(n)}function o(){var e=$(".main").innerHeight();if(window.innerWidth<769||e>1300)$("#jsFootPositionFix").css("height","0px");else{var t=window.innerHeight,n=Math.round(e+$("footer").innerHeight()+$("header").innerHeight()-t);n<0?(n=Math.abs(n),n-=45,$("#jsFootPositionFix").css("height",n+"px")):$("#jsFootPositionFix").css("height","0px")}}!function(){var t,i,a;!function(){if(e.indexOf("/Content/kirjastot")>-1)$('header li a[href$="/kirjastot"]').addClass("selected-nav");else if(e.indexOf("/Content/info")>-1)$('header li a[href$="/info"]').addClass("selected-nav");else if(e.indexOf("/Content/help_opac")>-1)$('header li a[href$="/info"]').addClass("selected-nav");else if(e.indexOf("/Content/help_accessibility")>-1)$('header li a[href$="/info"]').addClass("selected-nav");else if(e.indexOf("/Content/help_keski")>-1)$('header li a[href$="/info"]').addClass("selected-nav");else if(e.indexOf("/Feedback/Home")>-1)$('header li a[href$="/Feedback/Home"]').addClass("selected-nav");else if(e.indexOf("/Content/accessibility-statement")>-1)$('footer li a[href$="/Content/accessibility-statement"]').parent().addClass("selected-nav");else{if(e.indexOf("/Search/Results")>-1)return;$("#menu_Vinkit a").each((function(){if(e.indexOf(this.href)>-1){$("#menu_Vinkit").addClass("selected-nav");var t=this.href.substring(this.href.lastIndexOf("/")+1);$('#menu_Vinkit li a[href$="'+t+'"]').addClass("selected-nav")}})),$("#menu_eaineisto a").each((function(){if(e.indexOf(this.href)>-1){$("#menu_eaineisto").addClass("selected-nav");var t=this.href.substring(this.href.lastIndexOf("/")+1);$('li a[href$="'+t+'"]').addClass("selected-nav")}})),$("footer a").each((function(){e.indexOf(this.href)>-1&&$('li a[href$="'+window.location.pathname+'"]').addClass("selected-nav")}))}}(),function(){if(e.indexOf("/Search/Advanced")>-1||$(".adv_search_links").length)return $("section[role=search] .search-form-container").removeClass("search-form-container"),$("section[role=search]").css("visibility","hidden"),$("section[role=search]").removeClass("searchContent"),void $("section[role=search]").removeAttr("role");e.toLowerCase().indexOf("/content/help")>-1&&$("#searchHelpLink").parent().css("display","none"),e.indexOf("/Search/History")>-1&&$(".history-btn").parent().css("display","none")}(),n(),1===$(".keski-news-home").length&&(t=document.getElementById("libFrame"),(i=document.createElement("style")).type="text/css",i.innerHTML="#libFrame { transition: height 500ms;}",document.head.appendChild(i),window.addEventListener("message",(function(e){var n=e.data;if("resize"===n.type){var i=n.value;i<520&&(i=520),$(window).width()>767&&setTimeout((function(){var e=$("#keskiNewsUl").height();e=$(".news-page-link-container").height()+e,e=Math.floor(e);var t=$("#libFrame").height();t<e&&e-t<140&&(i=e+17,$("#libFrame").css("height",i+"px"),$("#libFrame").attr("height",i+"px"))}),1e3),t.style.height=i+"px"}else if("redirect"===n.type)try{window.location.href=n.value}catch(e){console.log("Redirect failed: "+e)}}))),e.indexOf("/Search/Results")>-1&&(window.onload=function(){!function(){$(".pagination-text .total").text(),$(".pagination-text span").each((function(e){var t=$(this).text();"Näytetään "!=t&&"Showing "!=t&&" results of "!=t||$(this).css("display","none")," results of "===$(t+"strong")&&$(this).css("display","none")}));var t=$(".pagination-text").html().replace(" results of "," / ");if($(".pagination-text").html(t),$(".pagination-text strong").each((function(e){var t=$(this).text();t=t.replace(/ /g,""),$(this).text(t)})),$(".pagination-container").css("visibility","visible"),$(".sort-option-container .sort-button span").prepend('<span class="sort-by">'+i18n.get("Order")+":</span>"),$(".limit-option-container .sort-button span").prepend('<span class="results-on-page">'+i18n.get("Show")+":</span>"),$(".control-container .view-dropdown .dropdown-toggle").prepend('<span class="results-on-page">'+i18n.get("View")+":</span>"),$(".fa-last-page").length){var n=$(".fa-last-page").parent(),i=new RegExp(/page=\d*/g),a=i.exec(n[0]);a=a[0].replace("page=","");var s=(i=new RegExp(/page=\d*/g)).exec(e),o=a-(s=null==s?0:s[0].replace("page=",""));$(window).width()<475&&($(".pagination .fa-arrow-alt-right").parent().css("display","none"),2!=s&&$(".pagination .fa-arrow-alt-left").parent().css("display","none")),o>2?$(".fa-last-page").prepend(" "+a):o<2&&($(".fa-arrow-alt-right").addClass("fa-last-page"),$(".fa-arrow-alt-right").removeClass("fa-arrow-alt-right"),$(n).parent().css("display","none")),2==s&&($(".pagination .fa-first-page").parent().css("display","none"),$(".fa-arrow-alt-left").addClass("fa-first-page"),$(".fa-arrow-alt-left").removeClass("fa-arrow-alt-left"))}"fi"===document.documentElement.lang.toLowerCase()?$('.filter-text:contains("Keski-kirjastot")')&&$(".filter-text").each((function(e){var t=$(this).text();t=t.replace("Keski-kirjastot > ",""),$(this).text(t)})):$('.filter-text:contains("Keski Libraries")')&&$(".filter-text").each((function(e){var t=$(this).text();t=t.replace("Keski Libraries > ",""),$(this).text(t)})),$(".filter-value").each((function(e){$(this).hasClass("filters-and")||$(this).hasClass("filters-or")||($(this).addClass("title-value-pair"),$(this).removeClass("filter-value"))})),0==$('div [data-facet="online_boolean:1"] .avail-count').text()&&$('div [data-facet="online_boolean:1"]').parent().parent().css("display","none");var r=$("#side-panel-subtitle_lng_str_mv .collapsed");$(r).click(),setTimeout((function(){var e=$("#side-collapse-subtitle_lng_str_mv .list-group-item").text();"Ei tietoja"==e||"No data available"==e?$("#side-collapse-subtitle_lng_str_mv").parent().css("display","none"):$("#side-panel-subtitle_lng_str_mv button").click()}),800)}()},$("#browseLi").css("display","none")),e.indexOf("/Record/keski")>-1&&(window.onload=function(){$(".finnaQrcodeLinkRecord").parent().css("display","none"),$(".export-toggle").parent().css("display","none")}),$(".main").append('<div class="sr-hidden" aria-hidden="true" id="jsFootPositionFix" style="height: 0;">&nbsp;</div>'),o();var s=!1;function r(){new Date-a<200?setTimeout(r,200):(s=!1,o(),setTimeout((function(){o()}),100))}$(window).resize((function(){a=new Date,!1===s&&(s=!0,setTimeout(r,200))}))}();
